
![image](https://user-images.githubusercontent.com/56060553/119281274-f6f5a580-bbe9-11eb-9021-a6ffb8980342.png)

# **Pharmaceutical Company CTI for Pfizer**

## _Milestone 1_

### **Introduction and Industry Background**
#### Pfizer Key Services/Products
Pfizer contributes to the healthcare industry through the development and manufacturing of healthcare products:
* Medicines
* Vaccines
* Consumer Healthcare

Pfizer has produced such notable products as:
* Lyrica – Pain Treatment
* Lipitor – Cholesterol Management
* Viagra – Erectile Disfunction
* Prevnar 13 – Pneumococcal Conjugate Vaccine
* Xtandi – Prostate Cancer Treatment
* COVID-19 Vaccine

#### Pfizer Key Services/Products
* #2 pharmaceutical company in the world with a revenue of $51.75B
* Revenue for the quarter ending March 31, 2021 was $14.582B, a 44.62% increase year-over-year.
* Employs approximately 88,000 people.
* Provides health products to over 150 countries.

![image](https://user-images.githubusercontent.com/56060553/119281200-a3835780-bbe9-11eb-8f4d-c73aab67ab21.png)

#### Pharmaceutical Industry Major Players
![image](https://user-images.githubusercontent.com/56060553/119281216-b39b3700-bbe9-11eb-8bf1-7da3dd8993c0.png)

#### Information Technology Roles
Information technology plays vital roles in several phases from beginning to end of the development and manufacturing processes
* Intellectual property data management and security
  * Experimental data
  * Patient data
* Computational resource availability
  * AI-driven drug development
* Manufacturing automation
* Supply chain security

### **Relevant Threat Trends and Critical Asset Identification**
#### Key Threats Targeting Industry
While biopharmaceutical companies have traditionally experienced cyber attacks frequently due to the valuable and critical services provided, certain companies working on COVID-19 vaccines have experienced a significant uptick in cyber attacks due to the value of the data and desire for knowledge of vaccine details.
**Ransomware Attacks**
* 77% of the total 20 companies examined had unsecured remote desktop protocol (RDP).
* Hacker groups have been targeting companies through ransomware attacks. These attacks rely heavily on exploiting RDP vulnerabilities and phishing.
* Known hacker groups: Maze, Ryuk, Revil/Sodinokibi, Netwalker and Nefilim
**COVID-19 Data Theft**
* Nation-state attacks: Russia, China, Iran and North Korea
**Supply Chain Attacks**
* Americold Logistics LLC vaccine cold-storage breach
#### Cyber Attack Trends
Attacks on the biopharma world are up 200% from 2017 to 2018 and another 50% from 2019 to 2020.
![image](https://user-images.githubusercontent.com/56060553/119281422-8ac77180-bbea-11eb-844a-5da280327976.png)
#### Key Industry Assets
1. Raw Materials
Quality raw materials are critical to the production of a reliable, high-quality product. Without a secure supply chain, the quality and confidence in the product would suffer which would affect the millions of potential consumers.
2. Critical Medicine Development/Manufacturing
When critical vaccines and other medicines are crucial to public health such as the COVID-19 vaccines and many other Pfizer products, they need to be reliably manufactured in the numbers necessary to satisfy the consumer base. Due to storage limitations, any halt in production could result in lack of availability. Without sufficient production, availability would be significantly reduced.
3. Patient Confidentiality
Patient confidentiality is of paramount importance. Pharmaceutical industries frequently use human test subjects to assist with confirming the viability and safety of new drugs being introduced into the market. In doing so, they must record private patient data and are then responsible for safeguarding that data. If that data is breached, the patient health information could be used to commit fraud or exploit patient weaknesses.
4. Intellectual Property
Intellectual property is the means by which a company can claim a product as its own and collect revenue on such products. The security of this information is crucial for a company to thrive to allow itself to serve as the sole proprietor of products in which they often have invested greatly. Without significant returns on these investments, companies have difficulty maintaining growth.
5. Public Confidence
Without public trust in a company or product, it is difficult to consistently maintain a solid customer base. The driver of sales of various products in the pharmaceutical industry is the demand by the customers, but if the company is misrepresented or if unfavorable data is leaked as a results of a data breach, public confidence in pharmaceutical products could suffer.
### **Diamond Models**
#### RDP Ransomware
![image](https://user-images.githubusercontent.com/56060553/119281479-be0a0080-bbea-11eb-8b3d-0c0825bd8c06.png)
#### Phishing Ransomware
![image](https://user-images.githubusercontent.com/56060553/119281487-c8c49580-bbea-11eb-94d4-3c7144e3f985.png)
#### Nation-State Attack 1
![image](https://user-images.githubusercontent.com/56060553/119281500-d1b56700-bbea-11eb-9d9b-000d462df298.png)
#### Nation-State Attack 2
![image](https://user-images.githubusercontent.com/56060553/119281519-de39bf80-bbea-11eb-82b0-cb52de09350a.png)
#### Cold-Storage Breach
![image](https://user-images.githubusercontent.com/56060553/119281534-e98ceb00-bbea-11eb-950c-b6f4b0496f97.png)
### **Intelligence Buy-In**
The efforts of hacker groups and nation-states to attack pharmaceutical companies working on COVID-19 vaccines has increased dramatically due to the monumental demand, valuable data, and new working conditions.
* The growing number of people working from home has resulted in an increased susceptibility to ransomware attacks through remote desktop vulnerabilities and increased phishing attacks.
* Nation-state attacks have grown due to the desire to learn the trade secrets of Pfizer and other company developments for the COVID-19 vaccine. This provides an opportunity for a nation-state to steal intellectual property to develop and sell their own version of the vaccine or create black market counterfeit vaccines.
* Pharmaceutical and biotech companies suffer more breaches than in any other industries.
* Pharmaceutical companies incur the 4th highest average cost per breach at $5.06M.

![image](https://user-images.githubusercontent.com/56060553/119281558-02959c00-bbeb-11eb-8f63-555ef1476652.png)
https://www.forbes.com/sites/forbesbusinesscouncil/2021/03/18/how-the-pharmaceutical-industry-can-secure-networks-to-avoid-cyberattacks/?sh=7d7297711eb3

Due to the increasing pharmaceutical industry attacks and high cost per attack, companies are being increasingly motivated to mitigate the effectiveness of these attacks.
* Pharmaceutical companies can no longer tolerate the losses incurred due to significant lost development time.
* Average metrics for pharmaceutical company recovery times:
  * Time Needed to Identify a Breach: **191 days**
  * Time Needed to Contain a Breach: **66 days**
  * Total Recovery Time: **257 days**

Pharmaceutical companies need to take a data-based approach to reduce the time needed to identify that a breach has occurred.
* Intrusion Detection Software
* Employee Security Awareness Training
* Simplified Approach to Security
* Qualified Information Security Experts

## _Milestone 2_

### **CTI Data Source Identification and Justification**
#### AlienVault OTX
![image](https://user-images.githubusercontent.com/56060553/122377102-9e2fd900-cf19-11eb-81d7-f81abb083eef.png)

https://otx.alienvault.com/
##### _Identification_
* AlienVault OTX (Open Threat Exchange) is a global community in which users generate and publish threat data
  * The threat data can be leveraged efficiently using open-source API to automate security updates and react to known threat indicators
  * OTX pulses provide a threat summary, information on the target, and indicators of compromise (IOCs) such as (IP address, domains, emails, etc.)
  * Over 19 million threat indicators are generated daily by over 100,000 participants in 140 countries
##### _Justification_
* Through leveraging the DirectConnect API in the company security tools, threats that are targeting the pharmaceutical industry can be exposed early and mitigated against
  * The crowd-sourced approach allows companies to catch and protect against threats early upon community exposure
  * Threat summaries are referred to as “pulses,” and they specify the related IOCs
  * AlienVault OTX is used in approximately 1,049 companies of varying sizes

![image](https://user-images.githubusercontent.com/56060553/122377322-d6cfb280-cf19-11eb-8ac4-f26b78fdc509.png)

https://enlyft.com/tech/products/alienvault#

#### Phishing Database
![image](https://user-images.githubusercontent.com/56060553/122377529-02eb3380-cf1a-11eb-9f1a-d5c94c067452.png)

Site: https://github.com/mitchellkrogza/Phishing.Database 
##### _Identification_
* Mitchell Krogza and his team leverage the PyFunceble testing tool to analyze and list active phishing domains:
  * Total Phishing Domains Captured: **306033**
  * Total Phishing Links Captured: **617809**
  * Phishing domains are determined to be active based on HTTP status codes
  * Companies can use this data to filter malicious emails and prevent them from reaching company employees
##### _Justification_
* Phishing is one of the most common ways that malicious actors attempt to exploit a company
* When blacklisting known phishing domains/links, these phishing attacks will not be carried out since it would not reach the intended host
* It is undetermined if companies leverage this specific source of phishing domains/links, but it is likely that some level of phishing prevention is in place for organizations within the pharmaceutical industry due to the cheap implementation and significant threats of exposure/loss when no safeguards are in place

![image](https://user-images.githubusercontent.com/56060553/122377745-2f06b480-cf1a-11eb-8111-02a9e686ca96.png)
### **Collection Strategies and Data Summary**
**NOTE**: For the purpose of this exercise, the data collected will pertain to the pharmaceutical industry in addition to individual biopharmaceutical companies.
#### AlienVault OTX
##### _Data Collection Methods_
*AlienVault OTX allows for querying pulses/IOCs based on tags and keywords
*For simplicity, we will query the database through the AlienVault OTX webpage for the following keywords: healthcare, financial, defense, and education.
*The number of IOCs for each keyword is indicative of the number of threats exposed to the various industries, and it illustrates the volume of the threats that a pharmaceutical company could likely face.
*This method of data collection is heavily dependent on the summary/tag data

![image](https://user-images.githubusercontent.com/56060553/122378310-b81deb80-cf1a-11eb-987e-6389e90811c7.png)

##### _What is a "Pulse"?_
* A pulse is a user-submitted group of IOCs that may contain related IOCs that target a certain industry or have a similar source.

![image](https://user-images.githubusercontent.com/56060553/123578483-d2619000-d78a-11eb-8119-1160ba8d7773.png)

##### _IOC Data Collection_

![image](https://user-images.githubusercontent.com/56060553/123578534-ef965e80-d78a-11eb-97b0-05d0bb5cfcfa.png)

**Takeaway**: The number of threat indicators for pharmaceuticals is comparable to other industries

##### _Sample Dataset_

The table shown below demonstrates the data associated with 50 pulses. Note that the IOC data in the right-most column is not being shown due to the extensive data included within.

![image](https://user-images.githubusercontent.com/56060553/123581326-7ef24080-d790-11eb-8c97-6b2275ea3b8d.png)

#### Phishing Database
##### _Data Collection_
Mitchell Krogza’s phishing database regularly generates updates to a list of phishing domains/links (Domains: 306033, Links: 617809)
These phishing sites along with legitimate sites can be parsed  and modeled to classify the common textual trends seen in scam sites versus legitimate sites

**Takeaway**: Many phishing domans/links are targeting pharmaceutical industries as well as customers/clients

##### _Sample Dataset_

_Sample of 50 Phishing Domain Names_

* 00000000000000000000000000000000000000dfjjjhv.000webhostapp.com
* 000000000000000000000000000000000000dbscrfg.000webhostapp.com
* 000000000000000000000000000yteyeuya.000webhostapp.com
* 00000000000000000dhl.000webhostapp.com
* 000000000000000ooooo.000webhostapp.com
* 00000000000000rqrewewrwrdfq.000webhostapp.com
* 0000000000000qowowiieueu0000000.000webhostapp.com
* 000000000a0uutlook.weebly.com
* 00000000920.us-south.cf.appdomain.cloud
* 0000000wer.000webhostapp.com
* 000000788-66666666.000webhostapp.com
* 00000078uu7u8790090900.000webhostapp.com
* 00-00-00-il.000webhostapp.com
* 0.00000.life
* 00000microsof.tonohost.com
* 00000skunnnn.000webhostapp.com
* 00001062.com
* 000012223.weebly.com
* 000012345000067890000.000webhostapp.com
* 000025123.com
* 00-002.weebly.com
* 8000032818.com
* 00003485.com
* 00005832.com
* 00009483.com
* 00009484.com
* 000098.ihostfull.com
* 0000bbffxzzzz900.000webhostapp.com
* 0000.com.my
* 0000promises.000webhostapp.com
* 0000wa0outlook.weebly.com
* 000102.ml
* 00012sbcglobal.weebly.com
* 000133210.000webhostapp.com
* 0001refund.info
* 0001safeworld0002.000webhostapp.com
* 00024390000067.000webhostapp.com
* 00025612.com
* 0002-i-nastolatek-to-przegrales-zycie-i-to-z-kretesem.fun
* 000340053.com
* 000838774343.000webhostapp.com
* 000-845int283-000.xyz
* 000945.000webhostapp.com
* 000asmr.com
* 000chgojhd78jhvbwreuvk.webnode.com
* 000codashoppfreee-771.duckdns.org
* 000dmobilt9034.com
* 000emailverifyingupdate.weebly.com
* 000escritoriohb.tonohost.com

## _Milestone 3_

### **Analytical Approaches and Justification & Preliminary Visualizations**
#### Phishing Database: Clustering
* Through using k-mean clustering, we can determine the commonalities among various phishing domain names to allow for the classification and future prediction of unknown phishing sites using machine learning techniques.

##### _Clustering Process:_
1. Import all phishing domains as a python list
2. Import the top 500 websites as a good domain list
3. Append the two lists, and precondition some of the data to make it model-compatible
4. Fit a PCA model based on the text data provided to represent the text data
5. Apply K-means clustering modeling algorithm
6. Observe clustering results

* Principal Component analysis allowed for text data to be represented as generic data for modeling purposes
* The red X’s represent the mid-points of the 2 k-means cluster groups which may lead to the predictable classification of new potentially harmful domain names
* This analysis leaves a bit to be desired since the data had to be significantly reduced due to computational limitations

![image](https://user-images.githubusercontent.com/56060553/123604225-81b05e00-d7af-11eb-8af6-cdf13e6a4504.png)

#### AlienVault OTX: Data Mining
* Harvest harmful IP addresses from AlienVault OTX by scraping the IOC databases of pulses tagged as being considered relevant to the healthcare industry
* With these IP addresses, the user can learn of the location of the attacker and can block them through the company’s firewall

##### _Data Mining Process (Using OTXv2 Python library):_
1. Automate a user subscription to various pulses by querying for pulses related to the healthcare industry (366 pulse were returned and my account subscribed to them)
2. Retrieve all pulses using the getall method
3. Retrieve all IPv4 indicators of the pulses in the subscription list
4. Save to a CSV file for later use (Approximately 3723 IP address were retrieved)

##### _Sample IPv4 Dataset_

![image](https://user-images.githubusercontent.com/56060553/123604195-78bf8c80-d7af-11eb-8a23-604a3f8abba6.png)

#### AlienVault OTX: Frequency Analysis
* Correlation of IP address reputation to the targeted industry and country of origin to indicate potential capability and motive of attacker
* Use AlienVault OTX API to extract IP addresses and provide a ranked list along with country of origin
* Through knowing the country of origin, it may be possible to establish the capabilities and motives of the attackers

##### _Process for country-of-origin IP address frequency analysis:_
1. Leverage the simple_geoip Python library
2. Lookup the country of origin of all IP addresses found in the pulse analysis
3. Count the occurrences of each country in the list
4. Plot a histogram demonstrating the frequencies of occurrences

* Takeaway: The United States is by far the highest frequency location of non-reputable IP Addresses
* It is likely that foreign attackers use the US as a proxy to hide their actual IP location
* Other IOC properties could be leveraged to solidify this analysis

![image](https://user-images.githubusercontent.com/56060553/123604274-8bd25c80-d7af-11eb-8716-2aa0ebbb968e.png)

* **NOTE:**  Only 1000 countries could be sampled due to IP location library limitations

### **Key Insights and Intelligence Summary**
#### Key Insights
##### _Types of infrastructure adversaries are using to conduct attacks_
###### **Email Servers**
* Improper training and tricky phishing sites necessitate a layer of security to detect new phishing emails before they reach the employee
###### **Insecure Network Ports**
* Another commonly compromised attack vector is through open ports that an attacker may access by breaching the network’s firewall and sending/receiving company network transactions to inject malware

##### _Emerging threats towards the industry, threat actors, and tactics_
* The threats to this industry are increasing from small-time hacktivists and cyber criminals to highly capable nation-state attacks
* Due to the COVID-19 pandemic, this industry has become a frequent victim of nation-state level attacks in addition to the already prevalent ransomware attacks

#### Intelligence Summary
##### _Phishing Site Detection/Classification Clustering Analysis_
* Through generating a robust classification model that classifies domain names as malicious or harmless, we could implement and continually improve upon a phishing safety net that protects email users from coming across malicious URLs
* One of the biggest difficulties in drawing the association would be the computational capabilities of the modeling hardware
* A more advanced approach may be able to assist the model to alleviate the need for the significant resources needed for model generation
##### _AlienVault OTX Data Mining and IP Address Location Analysis_
* Analyzing the IP addresses to determine the location of the adversaries can help determine the capabilities of the attacker as well as the motive
  * Frequent occurrences of highly-capable nation-state adversary such as China or Russia would have indicated a clear correlation between them and the healthcare industry
  * Due to the high frequency of United States locations, it’s likely that most attackers either mask their location through a proxy or there are far more local adversaries than nation-state adversaries
  * Further analysis with multiple IOCs could determine whether these IP addresses are masking the location of the actual attacker and it could determine the capabilities of the attackers

## _Milestone 4_

### **Summary: Key Insights and Intelligences**
#### _Emergence of New Threat Actors_
  * Previously, the primary goal of the attackers of the pharmaceutical industry have been pursuing large payouts through ransomware attacks
  * The threats to this industry are increasing from small-time hacktivists and cyber criminals to highly capable nation-state attackers
  * Due to the COVID-19 pandemic, this industry has become a frequent victim of nation-state level attacks in addition to the already prevalent ransomware attacks
  * Nation-state adversaries have significant resources and capabilities that allow them to subvert conventional protections
  * Location of attackers can be difficult to pinpoint through conventional methods due to their use proxies from which their detected IP addresses originate
  * Improved detection and protection measures must be taken to protect against highly capable adversaries

#### _Data Mining of Non-reputable IP Addresses_
  * In the case of AlienVault OTX, many non-reputable IP addresses and other IOC are captured by over 100,000 participants
  * IOC data is provided to the community to allow companies to protect their networks
  * Publicly-available Python API simplifies the process of extracting IOC data
  * The healthcare industry was among top industries that are often associated with non-reputable IP addresses
    * Financial Industry: 29,450 Known IOCs
    * Education Industry: 26,826 Known IOCs
    * Healthcare Industry: 21,127 Known IOCs

#### _Email Server Threat Infrastructure_
  * One of the most common methods for deploying malware is through URLs embedded in phishing emails
  * Through harvesting and analyzing data, classification methods were used to attempt to characterize URL name attributes that could classify legitimate URLs and malicious URLs
  * Through using this method, machine learning techniques could be utilized to train a model to detect various phishing URLs
  * Through using machine learning techniques additional models could potentially be implemented to have robust phishing threat prevention
  * Due to the adaptability of malicious attackers that may allow them to subvert the protections put in place through using ML techniques, employee training is one of the most important ways through which prevention can be achieved.

### **Operational Intelligence**
#### _Emergence of New Threat Actors_

##### _How do you intend to disseminate your discovered intelligence?_
* Become part of the Open Threat Exchange community to contribute IOC data to similar industries
* The IT staff needs to be continuously briefed on threat actors and attacker capabilities to emphasize the criticality of robust protections by email, online seminars, and cybersecurity conferences
* The IT staff will be notified via email/meetings on the attacker attempts and the state of protective measures

##### _What courses of action do you intend to implement based on your identified intelligence?_
* Known non-reputable IP addresses and other IOCs will be blocked by the network firewall and collected for further analysis
* Analysis of the attacker IP addresses will help to determine the location of the attacker which will provide evidence of attacker profile

##### _How can you use your discovered intelligence to inform your next iteration of CTI processes?_
* The CTI process will automatically detect known IOCs and alert the IT staff when they are detected
* The diamond models will be ranked and updated as more threat actors and capabilities are discovered

#### _Data Mining of Non-reputable IP Addresses_
##### _How do you intend to disseminate your discovered intelligence?_
* Become part of the Open Threat Exchange community to contribute IOC data to similar industries
* The IT security team will be involved throughout the entire process of utilizing this data
* The IT security team will have automated programs that periodically upload and parse IOC data

##### _What courses of do you intend to implement based on your identified intelligence?_
* The IT security team will be directly involved in the implementation of the IOC data in the network security infrastructure
* Malicious IP addresses will be blocked by the network firewall, and other IOC data will be implemented in a look-up table of the intrusion detection system

##### _How can you use your discovered intelligence to inform your next iteration of CTI processes?_
* Ensure that the use of IOCs is in the company’s security plan and IT user training
* Implement an intrusion detection system that detects malicious IP addresses, reports them, and prevents them from intruding into the company network

#### _Email Server Threat Infrastructure_
##### _How do you intend to disseminate your discovered intelligence?_
* Any phishing URLs that are detected and not in an existing database will be contributed to the prominent phishing databases
* IT staff will maintain the phishing site detection program
* Employees will be alerted via email if a phishing site makes it past the initial phishing site detection

##### _What courses of action do you intend to implement based on your identified intelligence?_
* A program will parse incoming emails for phishing URLs based on the database of known malicious URLs
* A text-based clustering algorithm will be used to determine if unknown URLs are malicious
* Undetected malicious emails will be flagged by trained personnel

##### _How can you use your discovered intelligence to inform your next iteration of CTI processes?_
* High-performance computing clusters will be acquired to train the complex text-based machine learning models

### **Future Advanced Functionalities for the CTI platform**
* Parse incoming emails for embedded URLs. Compare the URLs with those published in online phishing site databases as well as against the established classification model. Train all employees on the procedures that need to be followed before clicking an email URL.
  * **Justification:** The first line of defense when filtering phishing emails is using the known list of malicious URLs found within these emails. The next level of defense in this case would be the classification model that determines whether an email URL is legitimate or malicious. The last line of defense would be the situational awareness of the employee who receives the malicious email.
* Monitor AlienVault OTX IOC data to maintain an up-to-date database of malicious IP addresses and other indicators.
  * **Justification:** The data collected from the OTX community is tremendously valuable as it is a prolific source of data that can be directly applied to the security framework.
* Continually analyze the frequency of IP locations to detect trends and changes in the threat actor tendencies.
  * **Justification:** Increased nation-state attacks necessitate more stringent security practices. Therefore, we need to monitor the sources of the attacks to determine whether the cost of more stringent security measures is warranted.


